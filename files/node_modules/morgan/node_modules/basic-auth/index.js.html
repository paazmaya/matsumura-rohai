<h1>basic-auth</h1>
<pre><code class="lang-js"><span class="comment">/**
 * Parse the Authorization header field of `req`.
 *
 * @param {Request} req
 * @return {Object} with .name and .pass
 * @api public
 */</span>

module.exports = <span class="keyword">function</span>(req){
  req = req.req || req;

  <span class="keyword">var</span> auth = req.headers.authorization;
  <span class="keyword">if</span> (!auth) <span class="keyword">return</span>;

  <span class="comment">// malformed</span>
  <span class="keyword">var</span> parts = auth.split(<span class="string">' '</span>);
  <span class="keyword">if</span> (<span class="string">'basic'</span> != parts[<span class="number">0</span>].toLowerCase()) <span class="keyword">return</span>;
  <span class="keyword">if</span> (!parts[<span class="number">1</span>]) <span class="keyword">return</span>;
  auth = parts[<span class="number">1</span>];

  <span class="comment">// credentials</span>
  auth = <span class="keyword">new</span> Buffer(auth, <span class="string">'base64'</span>).toString();
  auth = auth.match(<span class="regexp">/^([^:]*):(.*)$/</span>);
  <span class="keyword">if</span> (!auth) <span class="keyword">return</span>;

  <span class="keyword">return</span> { name: auth[<span class="number">1</span>], pass: auth[<span class="number">2</span>] };
};
</code></pre>