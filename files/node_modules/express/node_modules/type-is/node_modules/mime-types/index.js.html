<h1>mime-types</h1>
<pre><code class="lang-js"><span class="keyword">var</span> db = require(<span class="string">'mime-db'</span>)

<span class="comment">// types[extension] = type</span>
exports.types = Object.create(<span class="literal">null</span>)
<span class="comment">// extensions[type] = [extensions]</span>
exports.extensions = Object.create(<span class="literal">null</span>)

Object.keys(db).forEach(<span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
  <span class="keyword">var</span> mime = db[name]
  <span class="keyword">var</span> exts = mime.extensions
  <span class="keyword">if</span> (!exts || !exts.length) <span class="keyword">return</span>
  exports.extensions[name] = exts
  exts.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(ext)</span> {</span>
    exports.types[ext] = name
  })
})

exports.lookup = <span class="function"><span class="keyword">function</span> <span class="params">(string)</span> {</span>
  <span class="keyword">if</span> (!string || <span class="keyword">typeof</span> string !== <span class="string">"string"</span>) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="comment">// remove any leading paths, though we should just use path.basename</span>
  string = string.replace(<span class="regexp">/.*[\.\/\\]/</span>, <span class="string">''</span>).toLowerCase()
  <span class="keyword">if</span> (!string) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="keyword">return</span> exports.types[string] || <span class="literal">false</span>
}

exports.extension = <span class="function"><span class="keyword">function</span> <span class="params">(type)</span> {</span>
  <span class="keyword">if</span> (!type || <span class="keyword">typeof</span> type !== <span class="string">"string"</span>) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="comment">// to do: use media-typer</span>
  type = type.match(<span class="regexp">/^\s*([^;\s]*)(?:;|\s|$)/</span>)
  <span class="keyword">if</span> (!type) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="keyword">var</span> exts = exports.extensions[type[<span class="number">1</span>].toLowerCase()]
  <span class="keyword">if</span> (!exts || !exts.length) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="keyword">return</span> exts[<span class="number">0</span>]
}

<span class="comment">// type has to be an exact mime type</span>
exports.charset = <span class="function"><span class="keyword">function</span> <span class="params">(type)</span> {</span>
  <span class="keyword">var</span> mime = db[type]
  <span class="keyword">if</span> (mime &amp;&amp; mime.charset) <span class="keyword">return</span> mime.charset

  <span class="comment">// default text/* to utf-8</span>
  <span class="keyword">if</span> (<span class="regexp">/^text\//</span>.test(type)) <span class="keyword">return</span> <span class="string">'UTF-8'</span>

  <span class="keyword">return</span> <span class="literal">false</span>
}

<span class="comment">// backwards compatibility</span>
exports.charsets = {
  lookup: exports.charset
}

<span class="comment">// to do: maybe use set-type module or something</span>
exports.contentType = <span class="function"><span class="keyword">function</span> <span class="params">(type)</span> {</span>
  <span class="keyword">if</span> (!type || <span class="keyword">typeof</span> type !== <span class="string">"string"</span>) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="keyword">if</span> (!~type.indexOf(<span class="string">'/'</span>)) type = exports.lookup(type)
  <span class="keyword">if</span> (!type) <span class="keyword">return</span> <span class="literal">false</span>
  <span class="keyword">if</span> (!~type.indexOf(<span class="string">'charset'</span>)) {
    <span class="keyword">var</span> charset = exports.charset(type)
    <span class="keyword">if</span> (charset) type += <span class="string">'; charset='</span> + charset.toLowerCase()
  }
  <span class="keyword">return</span> type
}
</code></pre>