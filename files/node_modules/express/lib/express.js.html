<h1>express.js</h1>
<pre><code class="lang-js"><span class="comment">/**
 * Module dependencies.
 */</span>

<span class="keyword">var</span> EventEmitter = require(<span class="string">'events'</span>).EventEmitter;
<span class="keyword">var</span> mixin = require(<span class="string">'utils-merge'</span>);
<span class="keyword">var</span> proto = require(<span class="string">'./application'</span>);
<span class="keyword">var</span> Route = require(<span class="string">'./router/route'</span>);
<span class="keyword">var</span> Router = require(<span class="string">'./router'</span>);
<span class="keyword">var</span> req = require(<span class="string">'./request'</span>);
<span class="keyword">var</span> res = require(<span class="string">'./response'</span>);

<span class="comment">/**
 * Expose `createApplication()`.
 */</span>

exports = module.exports = createApplication;

<span class="comment">/**
 * Create an express application.
 *
 * @return {Function}
 * @api public
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">createApplication</span><span class="params">()</span> {</span>
  <span class="keyword">var</span> app = <span class="keyword">function</span>(req, res, next) {
    app.handle(req, res, next);
  };

  mixin(app, proto);
  mixin(app, EventEmitter.prototype);

  app.request = { __proto__: req, app: app };
  app.response = { __proto__: res, app: app };
  app.init();
  <span class="keyword">return</span> app;
}

<span class="comment">/**
 * Expose the prototypes.
 */</span>

exports.application = proto;
exports.request = req;
exports.response = res;

<span class="comment">/**
 * Expose constructors.
 */</span>

exports.Route = Route;
exports.Router = Router;

<span class="comment">/**
 * Expose middleware
 */</span>

exports.query = require(<span class="string">'./middleware/query'</span>);
exports.static = require(<span class="string">'serve-static'</span>);

<span class="comment">/**
 * Replace removed middleware with an appropriate error message.
 */</span>

[
  <span class="string">'json'</span>,
  <span class="string">'urlencoded'</span>,
  <span class="string">'bodyParser'</span>,
  <span class="string">'compress'</span>,
  <span class="string">'cookieSession'</span>,
  <span class="string">'session'</span>,
  <span class="string">'logger'</span>,
  <span class="string">'cookieParser'</span>,
  <span class="string">'favicon'</span>,
  <span class="string">'responseTime'</span>,
  <span class="string">'errorHandler'</span>,
  <span class="string">'timeout'</span>,
  <span class="string">'methodOverride'</span>,
  <span class="string">'vhost'</span>,
  <span class="string">'csrf'</span>,
  <span class="string">'directory'</span>,
  <span class="string">'limit'</span>,
  <span class="string">'multipart'</span>,
  <span class="string">'staticCache'</span>,
].forEach(<span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
  Object.defineProperty(exports, name, {
    get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Most middleware (like '</span> + name + <span class="string">') is no longer bundled with Express and must be installed separately. Please see https://github.com/senchalabs/connect#middleware.'</span>);
    },
    configurable: <span class="literal">true</span>
  });
});
</code></pre>