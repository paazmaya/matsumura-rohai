<h1>ms</h1>
<pre><code class="lang-js"><span class="comment">/**
 * Helpers.
 */</span>

<span class="keyword">var</span> s = <span class="number">1000</span>;
<span class="keyword">var</span> m = s * <span class="number">60</span>;
<span class="keyword">var</span> h = m * <span class="number">60</span>;
<span class="keyword">var</span> d = h * <span class="number">24</span>;
<span class="keyword">var</span> y = d * <span class="number">365.25</span>;

<span class="comment">/**
 * Parse or format the given `val`.
 *
 * Options:
 *
 *  - `long` verbose formatting [false]
 *
 * @param {String|Number} val
 * @param {Object} options
 * @return {String|Number}
 * @api public
 */</span>

module.exports = <span class="keyword">function</span>(val, options){
  options = options || {};
  <span class="keyword">if</span> (<span class="string">'string'</span> == <span class="keyword">typeof</span> val) <span class="keyword">return</span> parse(val);
  <span class="keyword">return</span> options.long
    ? long(val)
    : short(val);
};

<span class="comment">/**
 * Parse the given `str` and return milliseconds.
 *
 * @param {String} str
 * @return {Number}
 * @api private
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">parse</span><span class="params">(str)</span> {</span>
  <span class="keyword">var</span> match = <span class="regexp">/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i</span>.exec(str);
  <span class="keyword">if</span> (!match) <span class="keyword">return</span>;
  <span class="keyword">var</span> n = parseFloat(match[<span class="number">1</span>]);
  <span class="keyword">var</span> type = (match[<span class="number">2</span>] || <span class="string">'ms'</span>).toLowerCase();
  <span class="keyword">switch</span> (type) {
    <span class="keyword">case</span> <span class="string">'years'</span>:
    <span class="keyword">case</span> <span class="string">'year'</span>:
    <span class="keyword">case</span> <span class="string">'y'</span>:
      <span class="keyword">return</span> n * y;
    <span class="keyword">case</span> <span class="string">'days'</span>:
    <span class="keyword">case</span> <span class="string">'day'</span>:
    <span class="keyword">case</span> <span class="string">'d'</span>:
      <span class="keyword">return</span> n * d;
    <span class="keyword">case</span> <span class="string">'hours'</span>:
    <span class="keyword">case</span> <span class="string">'hour'</span>:
    <span class="keyword">case</span> <span class="string">'h'</span>:
      <span class="keyword">return</span> n * h;
    <span class="keyword">case</span> <span class="string">'minutes'</span>:
    <span class="keyword">case</span> <span class="string">'minute'</span>:
    <span class="keyword">case</span> <span class="string">'m'</span>:
      <span class="keyword">return</span> n * m;
    <span class="keyword">case</span> <span class="string">'seconds'</span>:
    <span class="keyword">case</span> <span class="string">'second'</span>:
    <span class="keyword">case</span> <span class="string">'s'</span>:
      <span class="keyword">return</span> n * s;
    <span class="keyword">case</span> <span class="string">'ms'</span>:
      <span class="keyword">return</span> n;
  }
}

<span class="comment">/**
 * Short format for `ms`.
 *
 * @param {Number} ms
 * @return {String}
 * @api private
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">short</span><span class="params">(ms)</span> {</span>
  <span class="keyword">if</span> (ms >= d) <span class="keyword">return</span> Math.round(ms / d) + <span class="string">'d'</span>;
  <span class="keyword">if</span> (ms >= h) <span class="keyword">return</span> Math.round(ms / h) + <span class="string">'h'</span>;
  <span class="keyword">if</span> (ms >= m) <span class="keyword">return</span> Math.round(ms / m) + <span class="string">'m'</span>;
  <span class="keyword">if</span> (ms >= s) <span class="keyword">return</span> Math.round(ms / s) + <span class="string">'s'</span>;
  <span class="keyword">return</span> ms + <span class="string">'ms'</span>;
}

<span class="comment">/**
 * Long format for `ms`.
 *
 * @param {Number} ms
 * @return {String}
 * @api private
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">long</span><span class="params">(ms)</span> {</span>
  <span class="keyword">return</span> plural(ms, d, <span class="string">'day'</span>)
    || plural(ms, h, <span class="string">'hour'</span>)
    || plural(ms, m, <span class="string">'minute'</span>)
    || plural(ms, s, <span class="string">'second'</span>)
    || ms + <span class="string">' ms'</span>;
}

<span class="comment">/**
 * Pluralization helper.
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">plural</span><span class="params">(ms, n, name)</span> {</span>
  <span class="keyword">if</span> (ms &lt; n) <span class="keyword">return</span>;
  <span class="keyword">if</span> (ms &lt; n * <span class="number">1.5</span>) <span class="keyword">return</span> Math.floor(ms / n) + <span class="string">' '</span> + name;
  <span class="keyword">return</span> Math.ceil(ms / n) + <span class="string">' '</span> + name + <span class="string">'s'</span>;
}
</code></pre>