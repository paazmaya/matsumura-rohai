<h1>crc16_modbus.js</h1>
<pre><code class="lang-js"><span class="comment">// Generated by CoffeeScript 1.7.1</span>
<span class="keyword">var</span> Buffer, TABLE, create;

Buffer = require(<span class="string">'buffer'</span>).Buffer;

create = require(<span class="string">'./create'</span>);

TABLE = [<span class="number">0x0000</span>, <span class="number">0xc0c1</span>, <span class="number">0xc181</span>, <span class="number">0x0140</span>, <span class="number">0xc301</span>, <span class="number">0x03c0</span>, <span class="number">0x0280</span>, <span class="number">0xc241</span>, <span class="number">0xc601</span>, <span class="number">0x06c0</span>, <span class="number">0x0780</span>, <span class="number">0xc741</span>, <span class="number">0x0500</span>, <span class="number">0xc5c1</span>, <span class="number">0xc481</span>, <span class="number">0x0440</span>, <span class="number">0xcc01</span>, <span class="number">0x0cc0</span>, <span class="number">0x0d80</span>, <span class="number">0xcd41</span>, <span class="number">0x0f00</span>, <span class="number">0xcfc1</span>, <span class="number">0xce81</span>, <span class="number">0x0e40</span>, <span class="number">0x0a00</span>, <span class="number">0xcac1</span>, <span class="number">0xcb81</span>, <span class="number">0x0b40</span>, <span class="number">0xc901</span>, <span class="number">0x09c0</span>, <span class="number">0x0880</span>, <span class="number">0xc841</span>, <span class="number">0xd801</span>, <span class="number">0x18c0</span>, <span class="number">0x1980</span>, <span class="number">0xd941</span>, <span class="number">0x1b00</span>, <span class="number">0xdbc1</span>, <span class="number">0xda81</span>, <span class="number">0x1a40</span>, <span class="number">0x1e00</span>, <span class="number">0xdec1</span>, <span class="number">0xdf81</span>, <span class="number">0x1f40</span>, <span class="number">0xdd01</span>, <span class="number">0x1dc0</span>, <span class="number">0x1c80</span>, <span class="number">0xdc41</span>, <span class="number">0x1400</span>, <span class="number">0xd4c1</span>, <span class="number">0xd581</span>, <span class="number">0x1540</span>, <span class="number">0xd701</span>, <span class="number">0x17c0</span>, <span class="number">0x1680</span>, <span class="number">0xd641</span>, <span class="number">0xd201</span>, <span class="number">0x12c0</span>, <span class="number">0x1380</span>, <span class="number">0xd341</span>, <span class="number">0x1100</span>, <span class="number">0xd1c1</span>, <span class="number">0xd081</span>, <span class="number">0x1040</span>, <span class="number">0xf001</span>, <span class="number">0x30c0</span>, <span class="number">0x3180</span>, <span class="number">0xf141</span>, <span class="number">0x3300</span>, <span class="number">0xf3c1</span>, <span class="number">0xf281</span>, <span class="number">0x3240</span>, <span class="number">0x3600</span>, <span class="number">0xf6c1</span>, <span class="number">0xf781</span>, <span class="number">0x3740</span>, <span class="number">0xf501</span>, <span class="number">0x35c0</span>, <span class="number">0x3480</span>, <span class="number">0xf441</span>, <span class="number">0x3c00</span>, <span class="number">0xfcc1</span>, <span class="number">0xfd81</span>, <span class="number">0x3d40</span>, <span class="number">0xff01</span>, <span class="number">0x3fc0</span>, <span class="number">0x3e80</span>, <span class="number">0xfe41</span>, <span class="number">0xfa01</span>, <span class="number">0x3ac0</span>, <span class="number">0x3b80</span>, <span class="number">0xfb41</span>, <span class="number">0x3900</span>, <span class="number">0xf9c1</span>, <span class="number">0xf881</span>, <span class="number">0x3840</span>, <span class="number">0x2800</span>, <span class="number">0xe8c1</span>, <span class="number">0xe981</span>, <span class="number">0x2940</span>, <span class="number">0xeb01</span>, <span class="number">0x2bc0</span>, <span class="number">0x2a80</span>, <span class="number">0xea41</span>, <span class="number">0xee01</span>, <span class="number">0x2ec0</span>, <span class="number">0x2f80</span>, <span class="number">0xef41</span>, <span class="number">0x2d00</span>, <span class="number">0xedc1</span>, <span class="number">0xec81</span>, <span class="number">0x2c40</span>, <span class="number">0xe401</span>, <span class="number">0x24c0</span>, <span class="number">0x2580</span>, <span class="number">0xe541</span>, <span class="number">0x2700</span>, <span class="number">0xe7c1</span>, <span class="number">0xe681</span>, <span class="number">0x2640</span>, <span class="number">0x2200</span>, <span class="number">0xe2c1</span>, <span class="number">0xe381</span>, <span class="number">0x2340</span>, <span class="number">0xe101</span>, <span class="number">0x21c0</span>, <span class="number">0x2080</span>, <span class="number">0xe041</span>, <span class="number">0xa001</span>, <span class="number">0x60c0</span>, <span class="number">0x6180</span>, <span class="number">0xa141</span>, <span class="number">0x6300</span>, <span class="number">0xa3c1</span>, <span class="number">0xa281</span>, <span class="number">0x6240</span>, <span class="number">0x6600</span>, <span class="number">0xa6c1</span>, <span class="number">0xa781</span>, <span class="number">0x6740</span>, <span class="number">0xa501</span>, <span class="number">0x65c0</span>, <span class="number">0x6480</span>, <span class="number">0xa441</span>, <span class="number">0x6c00</span>, <span class="number">0xacc1</span>, <span class="number">0xad81</span>, <span class="number">0x6d40</span>, <span class="number">0xaf01</span>, <span class="number">0x6fc0</span>, <span class="number">0x6e80</span>, <span class="number">0xae41</span>, <span class="number">0xaa01</span>, <span class="number">0x6ac0</span>, <span class="number">0x6b80</span>, <span class="number">0xab41</span>, <span class="number">0x6900</span>, <span class="number">0xa9c1</span>, <span class="number">0xa881</span>, <span class="number">0x6840</span>, <span class="number">0x7800</span>, <span class="number">0xb8c1</span>, <span class="number">0xb981</span>, <span class="number">0x7940</span>, <span class="number">0xbb01</span>, <span class="number">0x7bc0</span>, <span class="number">0x7a80</span>, <span class="number">0xba41</span>, <span class="number">0xbe01</span>, <span class="number">0x7ec0</span>, <span class="number">0x7f80</span>, <span class="number">0xbf41</span>, <span class="number">0x7d00</span>, <span class="number">0xbdc1</span>, <span class="number">0xbc81</span>, <span class="number">0x7c40</span>, <span class="number">0xb401</span>, <span class="number">0x74c0</span>, <span class="number">0x7580</span>, <span class="number">0xb541</span>, <span class="number">0x7700</span>, <span class="number">0xb7c1</span>, <span class="number">0xb681</span>, <span class="number">0x7640</span>, <span class="number">0x7200</span>, <span class="number">0xb2c1</span>, <span class="number">0xb381</span>, <span class="number">0x7340</span>, <span class="number">0xb101</span>, <span class="number">0x71c0</span>, <span class="number">0x7080</span>, <span class="number">0xb041</span>, <span class="number">0x5000</span>, <span class="number">0x90c1</span>, <span class="number">0x9181</span>, <span class="number">0x5140</span>, <span class="number">0x9301</span>, <span class="number">0x53c0</span>, <span class="number">0x5280</span>, <span class="number">0x9241</span>, <span class="number">0x9601</span>, <span class="number">0x56c0</span>, <span class="number">0x5780</span>, <span class="number">0x9741</span>, <span class="number">0x5500</span>, <span class="number">0x95c1</span>, <span class="number">0x9481</span>, <span class="number">0x5440</span>, <span class="number">0x9c01</span>, <span class="number">0x5cc0</span>, <span class="number">0x5d80</span>, <span class="number">0x9d41</span>, <span class="number">0x5f00</span>, <span class="number">0x9fc1</span>, <span class="number">0x9e81</span>, <span class="number">0x5e40</span>, <span class="number">0x5a00</span>, <span class="number">0x9ac1</span>, <span class="number">0x9b81</span>, <span class="number">0x5b40</span>, <span class="number">0x9901</span>, <span class="number">0x59c0</span>, <span class="number">0x5880</span>, <span class="number">0x9841</span>, <span class="number">0x8801</span>, <span class="number">0x48c0</span>, <span class="number">0x4980</span>, <span class="number">0x8941</span>, <span class="number">0x4b00</span>, <span class="number">0x8bc1</span>, <span class="number">0x8a81</span>, <span class="number">0x4a40</span>, <span class="number">0x4e00</span>, <span class="number">0x8ec1</span>, <span class="number">0x8f81</span>, <span class="number">0x4f40</span>, <span class="number">0x8d01</span>, <span class="number">0x4dc0</span>, <span class="number">0x4c80</span>, <span class="number">0x8c41</span>, <span class="number">0x4400</span>, <span class="number">0x84c1</span>, <span class="number">0x8581</span>, <span class="number">0x4540</span>, <span class="number">0x8701</span>, <span class="number">0x47c0</span>, <span class="number">0x4680</span>, <span class="number">0x8641</span>, <span class="number">0x8201</span>, <span class="number">0x42c0</span>, <span class="number">0x4380</span>, <span class="number">0x8341</span>, <span class="number">0x4100</span>, <span class="number">0x81c1</span>, <span class="number">0x8081</span>, <span class="number">0x4040</span>];

<span class="keyword">if</span> (<span class="keyword">typeof</span> Int32Array !== <span class="string">'undefined'</span>) {
  TABLE = <span class="keyword">new</span> Int32Array(TABLE);
}

module.exports = create(<span class="keyword">function</span>(buf, previous) {
  <span class="keyword">var</span> byte, crc, _i, _len;
  <span class="keyword">if</span> (!Buffer.isBuffer(buf)) {
    buf = Buffer(buf);
  }
  crc = ~~previous || <span class="number">0xffff</span>;
  <span class="keyword">for</span> (_i = <span class="number">0</span>, _len = buf.length; _i &lt; _len; _i++) {
    byte = buf[_i];
    crc = (TABLE[(crc ^ byte) &amp; <span class="number">0xff</span>] ^ (crc >> <span class="number">8</span>)) &amp; <span class="number">0xffff</span>;
  }
  <span class="keyword">return</span> crc;
});
</code></pre>